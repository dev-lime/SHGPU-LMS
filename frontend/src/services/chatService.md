# Документация сервиса чатов

## `createOrGetChat(userId)`

### Описание
Сервисная функция для создания или получения существующего чата между текущим аутентифицированным пользователем и указанным пользователем. Сначала проверяет наличие существующего чата, и если его нет - создает новый.

### Параметры
- `userId` (string): ID пользователя, с которым нужно начать чат

### Возвращаемое значение
- `Promise<string>`: Возвращает ID чата (существующего или нового)

### Логика работы
1. **Проверка аутентификации**: Убеждается, что пользователь авторизован
2. **Защита от чата с собой**: Блокирует создание чата с самим собой
3. **Поиск существующего чата**: Ищет уже существующий чат между этими пользователями
4. **Создание нового чата**: Если чата не существует, создает новый с:
   - Участниками (оба пользователя)
   - Именами участников
   - Временем создания
   - Первым сообщением "Чат создан"
   - Временем последнего обновления

### Обработка ошибок
Выбрасывает ошибки в случаях:
- Неавторизованный пользователь
- Попытка создать чат с самим собой
- Ошибки работы с Firestore

### Пример использования
```javascript
try {
  const chatId = await createOrGetChat('ID-пользователя');
  // Переход к чату или другие действия
} catch (error) {
  console.error('Ошибка чата:', error);
  // Обработка ошибки
}
```

### Зависимости
- Firebase Firestore
- Firebase Authentication
